# 人工走查清单 (QA Checklist): App.tsx 重构验收

请使用此清单验证 `App.tsx` 重构是否引入了 **功能倒退 (Regressions)**。请尽可能对比重构前的版本 (commit `ad59f3c`) 进行验收。

## 1. 全局布局与导航 (Top-Level Layout)
- [ ] **初始化加载**:
    - [ ] 应用启动无白屏，控制台无报错。
    - [ ] 布局严格保持三栏结构 + 顶部导航 + 底部历史栏。
- [ ] **面板调整 (Resizing)**:
    - [ ] 左侧分割线 (图片面板) 可拖拽调整宽度。
    - [ ] 右侧分割线 (聊天面板) 可拖拽调整宽度。
    - [ ] 面板宽度受最小/最大值限制，不会无限拖拽。
- [ ] **顶部导航交互**:
    - [ ] "语言" 切换 (中/英) 立即生效。
    - [ ] "API 模式" 下拉菜单功能正常 (Official / Custom / Volcengine)。
    - [ ] 点击 "API Key" 图标可打开设置弹窗。

## 2. 左侧面板: 主视觉区 (MainVisualizer)
- [ ] **图片显示**:
    - [ ] **拖拽上传**: 拖入图片/视频显示遮罩层，并成功加载图片与提示词。
    - [ ] **输入源表头**: 加载图片后显示 "Compare" (对比) 和 "Focus" (聚焦) 按钮。
    - [ ] **重置任务**: 点击 (+) 按钮可清空当前状态。
- [ ] **缩放与平移**:
    - [ ] 鼠标滚轮可缩放图片。
    - [ ] 放大后按住鼠标左键可平移图片。
    - [ ] 全屏图标点击有效。
- [ ] **对比滑块 (Comparison Slider)**:
    - [ ] 点击 "Compare" 按钮 (或表头开关) 进入对比模式。
    - [ ] 滑块移动流畅，左右分别显示生成图与原图。
    - [ ] "下载 HD" 图标点击有效。

## 3. 右侧面板: Agent 工作台 (AgentWorkbench)
- [ ] **标签页切换**:
    - [ ] 点击 "STUDIO", "场景 (AUDITOR)", "材质 (DESCRIPTOR)", "构图 (ARCHITECT)" 可正确切换内容。
    - [ ] 选中标签页的高亮样式 (橙色/下划线) 正确。
- [ ] **Agent 内容**:
    - [ ] "场景/材质/构图" 标签页显示 Agent 卡片及聊天内容。
    - [ ] Agent 卡片中的 "Regenerate" (重新生成) 按钮点击有效。

## 4. 中间/核心面板: 提示词工作室 (PromptStudio)
- [ ] **头部区域 (Header)**:
    - [ ] **版本选择下拉框**: 点击展开，菜单**不被遮挡**。选择版本后 UI 更新。
    - [ ] **历史记录下拉框**: 显示记录数量。点击展开。鼠标悬停在条目上显示 "差异预览 (Diff)" 面板。
    - [ ] **同步**: 点击历史记录条目，可恢复提示词内容。
- [ ] **编辑器区域**:
    - [ ] 提示词输入框可正常输入/编辑。
    - [ ] **优化 (Refine) 菜单**: 点击浮现 4 个选项，**不被底部遮挡**。
    - [ ] **逆向 (Reverse) 菜单**: 点击浮现快速/完整逆向选项，**不被底部遮挡**。
    - [ ] **生成 (Generate) 菜单**: 左侧下拉箭头点击浮现图片数量选择 (1/2/4)。
- [ ] **快捷键**:
    - [ ] `Cmd+Enter` 触发生成。
    - [ ] `Alt+R` (或鼠标悬停) 显示快捷键提示。
    - [ ] 按钮 Tooltips 显示清晰，不被裁切。

## 5. 右侧边栏: 聊天 (ChatSidebar)
- [ ] **开关**:
    - [ ] 可通过 PromptStudio 底部工具栏右侧的图标 (或 Agent 卡片) 打开/关闭。
- [ ] **内容**:
    - [ ] 聊天记录显示正确，无样式错乱。
    - [ ] 用户与 AI 的对话气泡样式分明。

## 6. 逻辑与一致性
- [ ] **数据持久化**:
    - [ ] 刷新页面后，API Key 和基础设置 (如 API 模式) 保持不变。
- [ ] **重构专项检查**:
    - [ ] 控制台无 "React Key duplication" 重复 Key 报错。
    - [ ] 快速切换标签页时无 `undefined` 或 `null` 崩溃报错。

## 7. 安全性与鲁棒性 (Security & Robustness)
- [ ] **API 模式热切换保护**:
    - [ ] 在生成图片或运行流水线时，尝试点击底部的 API 模式切换按钮。
    - [ ] **预期**: 按钮应变灰 (opacity-50)，鼠标变为禁用状态，点击无反应。
    - [ ] **预期**: Hover 时显示 Tooltip "任务执行中，禁止切换 API"。
- [ ] **提示词版本管理**:
    - [ ] 切换 Prompt 版本后，编辑器内容应立即更新，不存在滞后。
